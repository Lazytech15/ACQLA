const _0x167705=_0x3d03;function _0x3d03(_0x180bf7,_0x352568){const _0x4fd965=_0x4fd9();return _0x3d03=function(_0x3d0307,_0x4dde38){_0x3d0307=_0x3d0307-0x12b;let _0xb600d1=_0x4fd965[_0x3d0307];return _0xb600d1;},_0x3d03(_0x180bf7,_0x352568);}(function(_0x3fd650,_0x168af3){const _0x1e42d6=_0x3d03,_0x1547de=_0x3fd650();while(!![]){try{const _0x3832f1=-parseInt(_0x1e42d6(0x153))/0x1+parseInt(_0x1e42d6(0x16e))/0x2*(-parseInt(_0x1e42d6(0x13b))/0x3)+-parseInt(_0x1e42d6(0x159))/0x4+-parseInt(_0x1e42d6(0x12f))/0x5+-parseInt(_0x1e42d6(0x144))/0x6+parseInt(_0x1e42d6(0x13c))/0x7*(-parseInt(_0x1e42d6(0x147))/0x8)+parseInt(_0x1e42d6(0x13d))/0x9;if(_0x3832f1===_0x168af3)break;else _0x1547de['push'](_0x1547de['shift']());}catch(_0x177191){_0x1547de['push'](_0x1547de['shift']());}}}(_0x4fd9,0xe3df7));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js';const firebaseConfig={'apiKey':_0x167705(0x150),'authDomain':_0x167705(0x140),'projectId':_0x167705(0x143),'storageBucket':_0x167705(0x145),'messagingSenderId':_0x167705(0x16c),'appId':_0x167705(0x160)},app=initializeApp(firebaseConfig);firebase[_0x167705(0x137)](firebaseConfig);import{getFirestore,doc,getDoc,collection,addDoc,setDoc,updateDoc,deleteDoc,deleteField,onSnapshot}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';const db=getFirestore(),client=firebase[_0x167705(0x14b)]();let count,studeData;const studentName=document[_0x167705(0x155)](_0x167705(0x162)),studentID=document[_0x167705(0x155)](_0x167705(0x169)),studentSec=document[_0x167705(0x155)](_0x167705(0x17d)),studentSub=document[_0x167705(0x155)](_0x167705(0x176)),pcunit=document[_0x167705(0x155)](_0x167705(0x17b)),DateHour=document['getElementById']('TimeDate'),stud_late=document[_0x167705(0x155)](_0x167705(0x136)),stud_ontime=document[_0x167705(0x155)]('stud_ontime'),toccupied=document[_0x167705(0x155)](_0x167705(0x14a)),pcavailable=document['getElementById'](_0x167705(0x133)),donwload_btn=document['getElementById'](_0x167705(0x146)),reset_btn=document[_0x167705(0x155)]('reset_btn');let deskStat=[],dataID;async function checkSit(){const _0x56cc19=_0x167705;client['collection'](_0x56cc19(0x131))[_0x56cc19(0x166)](_0x418cb9=>{const _0x2d1dd9=_0x56cc19;_0x418cb9[_0x2d1dd9(0x17c)](_0x1c303b=>{const _0x3d8249=_0x2d1dd9;studeData=_0x1c303b[_0x3d8249(0x173)](),dataID=_0x1c303b['id'],deskStat[_0x3d8249(0x167)]({...studeData,'dataID':dataID});}),deskStat[_0x2d1dd9(0x17c)](_0x597d18=>{const _0x5c0e78=_0x2d1dd9;if(_0x597d18[_0x5c0e78(0x15a)]===_0x5c0e78(0x172)&&_0x597d18['SchoolOnTime']===_0x5c0e78(0x158)){toccupied[_0x5c0e78(0x16a)]=Number(toccupied[_0x5c0e78(0x16a)])+0x1,stud_late['innerHTML']=Number(stud_late[_0x5c0e78(0x16a)])+0x1,pcavailable[_0x5c0e78(0x16a)]=Number(pcavailable[_0x5c0e78(0x16a)])-0x1;const _0x1a0990=document[_0x5c0e78(0x15e)]('td');_0x1a0990[_0x597d18['Desk']][_0x5c0e78(0x139)]=_0x5c0e78(0x16d),_0x1a0990[_0x597d18[_0x5c0e78(0x12d)]][_0x5c0e78(0x16a)]=_0x5c0e78(0x178)+_0x597d18[_0x5c0e78(0x181)]+_0x5c0e78(0x168)+_0x5c0e78(0x134);}else{if(_0x597d18['Status']===_0x5c0e78(0x172)&&_0x597d18[_0x5c0e78(0x17e)]===_0x5c0e78(0x138)){toccupied[_0x5c0e78(0x16a)]=Number(toccupied[_0x5c0e78(0x16a)])+0x1,stud_ontime['innerHTML']=Number(stud_ontime['innerHTML'])+0x1,pcavailable[_0x5c0e78(0x16a)]=Number(pcavailable[_0x5c0e78(0x16a)])-0x1;const _0x34fef1=document[_0x5c0e78(0x15e)]('td');_0x34fef1[_0x597d18['Desk']][_0x5c0e78(0x139)]=_0x5c0e78(0x170),_0x34fef1[_0x597d18['Desk']][_0x5c0e78(0x16a)]=_0x5c0e78(0x178)+_0x597d18['Com_Unit_Num']+_0x5c0e78(0x168)+_0x5c0e78(0x14d);}else{const _0x3f18ec=document['getElementsByTagName']('td');_0x3f18ec[_0x597d18[_0x5c0e78(0x12d)]][_0x5c0e78(0x139)]=_0x5c0e78(0x149);}}});});}function _0x4fd9(){const _0x37f85d=['getElementById','SOME-IS-TYPING','STUDENT\x20NUMBER','true','5017564lUOosa','Status','info-container','addEventListener','book_new','getElementsByTagName','book_append_sheet','1:316552887176:web:2d8b0fc17477132873d83d','new','studentName','reload','Com-Lab-Attendance.xlsx','Student_Name','onSnapshot','push','</span>','studentID','innerHTML','background-color:\x20purple;\x20padding:\x2010px;\x20','316552887176','background-color:\x20yellow;\x20padding:10px;\x20color:\x20navy;','4CsNwBd','STUDENT\x20NAME','background-color:\x20red;\x20padding:10px;','DOMContentLoaded','Occupied','data','map','Student_Section','studentsub','application/octet-stream','<span\x20class=\x22desk\x22>','maxHeight','LATE','pcnum','forEach','studentSection','SchoolOnTime','Student_Course','COURSE\x20CODE','Com_Unit_Num','display:\x20flex;','collection','Desk','click','7907165PJKdOs','Delete\x20Successfully','COMLAB-ATTENDANCE-TABLE','write','pcavailable','Occupied!\x20<br>\x20BUT\x20LATE!','background-color:\x20lightgreen;\x20padding:\x2010px;\x20','stud_late','initializeApp','false','style','minimal-details-info','2094522jeKWas','3657934SQADVw','68548194AjJrFC','xlsx','charCodeAt','cpprog03.firebaseapp.com','Date_Scan','opacity','cpprog03','5593344DbwInR','cpprog03.appspot.com','donwload_btn','16DVXdvo','1000px','background-color:\x20lightgreen;\x20padding:10px','toccupied','firestore','pointerenter','Occupied!\x20<br>\x20Ontime','utils','length','AIzaSyCOB2qEHCqj4ogZdjIH4Ff-tl-StyLShOk','json_to_sheet','Student_ID','473579ENXISy','Not\x20in\x20there\x20yet'];_0x4fd9=function(){return _0x37f85d;};return _0x4fd9();}donwload_btn[_0x167705(0x15c)](_0x167705(0x12e),function(){const _0x3c2c8b=_0x167705;if(deskStat=='')alert(_0x3c2c8b(0x154));else{const _0x2c0862=[{'old':_0x3c2c8b(0x152),'new':_0x3c2c8b(0x157)},{'old':'Student_Name','new':_0x3c2c8b(0x16f)},{'old':_0x3c2c8b(0x175),'new':'SECTION'},{'old':_0x3c2c8b(0x17f),'new':_0x3c2c8b(0x180)},{'old':'Com_Unit_Num','new':'PC\x20NUMBER'},{'old':_0x3c2c8b(0x141),'new':'TIME/DATE\x20SCANNED'},{'old':'SchoolOnTime','new':_0x3c2c8b(0x17a)}];function _0x361249(_0x568ce5){const _0xae9134=_0x3c2c8b,_0x4cc8f7={};for(var _0x542c07=0x0;_0x542c07<_0x2c0862[_0xae9134(0x14f)];_0x542c07++){var _0x22f744=_0x2c0862[_0x542c07]['old'],_0x157580=_0x2c0862[_0x542c07][_0xae9134(0x161)];_0x568ce5['hasOwnProperty'](_0x22f744)&&(_0x4cc8f7[_0x157580]=_0x568ce5[_0x22f744]);}return _0x4cc8f7;}const _0x5742b7=deskStat[_0x3c2c8b(0x174)](_0x361249),_0x364f37=XLSX[_0x3c2c8b(0x14e)][_0x3c2c8b(0x151)](_0x5742b7),_0x2356b7=XLSX[_0x3c2c8b(0x14e)][_0x3c2c8b(0x15d)]();XLSX[_0x3c2c8b(0x14e)][_0x3c2c8b(0x15f)](_0x2356b7,_0x364f37,'Attendance');const _0x215026=XLSX[_0x3c2c8b(0x132)](_0x2356b7,{'bookType':_0x3c2c8b(0x13e),'type':'binary'});function _0x491284(_0x43f40f){const _0x48265e=_0x3c2c8b,_0x8f2c00=new ArrayBuffer(_0x43f40f[_0x48265e(0x14f)]),_0x1bd05b=new Uint8Array(_0x8f2c00);for(let _0x1c9a77=0x0;_0x1c9a77<_0x43f40f[_0x48265e(0x14f)];_0x1c9a77++)_0x1bd05b[_0x1c9a77]=_0x43f40f[_0x48265e(0x13f)](_0x1c9a77)&0xff;return _0x8f2c00;}saveAs(new Blob([_0x491284(_0x215026)],{'type':_0x3c2c8b(0x177)}),_0x3c2c8b(0x164)),deletData();}});async function deletData(){const _0x42640d=_0x167705;client['collection'](_0x42640d(0x131))[_0x42640d(0x166)](_0x111607=>{const _0x5dc56b=_0x42640d;_0x111607[_0x5dc56b(0x17c)](_0x136ebf=>{const _0x4487e6=_0x5dc56b,_0x2df793=_0x136ebf['id'],_0x202c55=doc(db,_0x4487e6(0x131),_0x2df793);deleteDoc(_0x202c55),alert(_0x4487e6(0x130)),setInterval(function(){const _0x2458f2=_0x4487e6;location[_0x2458f2(0x163)]();},0x1388);});}),client[_0x42640d(0x12c)](_0x42640d(0x156))[_0x42640d(0x166)](_0x525ff0=>{const _0x55edee=_0x42640d;_0x525ff0[_0x55edee(0x17c)](_0x55a5e5=>{const _0x3e0730=_0x55edee,_0x57fa9c=_0x55a5e5['id'],_0x21cfa7=doc(db,_0x3e0730(0x131),_0x57fa9c);deleteDoc(_0x21cfa7);});});}reset_btn['addEventListener'](_0x167705(0x12e),function(){deskStat==''?alert('Not\x20in\x20there\x20yet'):deletData();});const minimaldetails=document[_0x167705(0x155)](_0x167705(0x13a)),infodetails=document[_0x167705(0x155)](_0x167705(0x15b));document[_0x167705(0x15c)](_0x167705(0x171),function(){const _0x302ec0=_0x167705;let _0x24dbcb=document[_0x302ec0(0x15e)]('td');for(let _0x4dfa9e=0x0;_0x4dfa9e<_0x24dbcb[_0x302ec0(0x14f)];_0x4dfa9e++){(function(_0x32a780){const _0x171148=_0x302ec0;_0x24dbcb[_0x32a780][_0x171148(0x15c)](_0x171148(0x14c),function(){const _0x4273c6=_0x171148;_0x24dbcb[_0x32a780][_0x4273c6(0x16a)]!==''?deskStat['forEach'](_0x399be3=>{const _0x5563cb=_0x4273c6,_0x86b607=_0x399be3[_0x5563cb(0x12d)];_0x32a780==_0x86b607&&(pcunit[_0x5563cb(0x16a)]=_0x399be3['Com_Unit_Num'],studentName['innerHTML']=_0x399be3[_0x5563cb(0x165)],studentID[_0x5563cb(0x16a)]=_0x399be3[_0x5563cb(0x152)],studentSec[_0x5563cb(0x16a)]=_0x399be3[_0x5563cb(0x175)],studentSub['innerHTML']=_0x399be3[_0x5563cb(0x17f)],DateHour['innerHTML']=_0x399be3['Date_Scan']),document['getElementById'](_0x5563cb(0x15b))[_0x5563cb(0x139)]=_0x5563cb(0x12b),minimaldetails[_0x5563cb(0x139)][_0x5563cb(0x142)]='0',minimaldetails[_0x5563cb(0x139)][_0x5563cb(0x179)]='0';}):(minimaldetails[_0x4273c6(0x139)][_0x4273c6(0x142)]='1',minimaldetails[_0x4273c6(0x139)][_0x4273c6(0x179)]=_0x4273c6(0x148),infodetails[_0x4273c6(0x139)][_0x4273c6(0x142)]='0',infodetails['style']['maxHeight']='0');}),_0x24dbcb[_0x32a780]['addEventListener'](_0x171148(0x12e),function(){});}(_0x4dfa9e));}});async function TypingCheck(){const _0x2e360b=_0x167705;let _0x4f17fc=[];const _0x235519=document['getElementsByTagName']('td');for(let _0x169474=0x0;_0x169474<_0x235519['length'];_0x169474++){client['collection'](_0x2e360b(0x156))['onSnapshot'](_0x1e31fd=>{const _0xa6343e=_0x2e360b;_0x1e31fd[_0xa6343e(0x17c)](_0x34fccd=>{const _0x5b213c=_0xa6343e,_0x4d772e=_0x34fccd[_0x5b213c(0x173)]()[_0x5b213c(0x12d)];_0x235519[_0x4d772e][_0x5b213c(0x139)]=_0x5b213c(0x16b),_0x4f17fc=_0x4d772e;}),_0x4f17fc===_0x169474&&(_0x235519[_0x169474][_0xa6343e(0x139)]=_0xa6343e(0x135));});}}window['onload']=function(){TypingCheck(),checkSit();},setInterval(function(){count<0x3?count++:(location['reload'](),count='');},0x4e20);
