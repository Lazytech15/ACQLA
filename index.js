function _0xefa7(_0xe1ff9,_0x24de80){const _0x3f9bd3=_0x3f9b();return _0xefa7=function(_0xefa72e,_0x42f7c5){_0xefa72e=_0xefa72e-0xa2;let _0x4cdfe1=_0x3f9bd3[_0xefa72e];return _0x4cdfe1;},_0xefa7(_0xe1ff9,_0x24de80);}const _0x1ce7d8=_0xefa7;(function(_0x28e988,_0x32f96d){const _0x2b84bb=_0xefa7,_0x2b3420=_0x28e988();while(!![]){try{const _0x435bcd=-parseInt(_0x2b84bb(0xcd))/0x1*(-parseInt(_0x2b84bb(0xee))/0x2)+parseInt(_0x2b84bb(0xc2))/0x3*(-parseInt(_0x2b84bb(0xdc))/0x4)+-parseInt(_0x2b84bb(0xb7))/0x5+-parseInt(_0x2b84bb(0xe5))/0x6*(parseInt(_0x2b84bb(0xbf))/0x7)+-parseInt(_0x2b84bb(0xd1))/0x8+-parseInt(_0x2b84bb(0xaf))/0x9*(-parseInt(_0x2b84bb(0xda))/0xa)+parseInt(_0x2b84bb(0xdf))/0xb*(parseInt(_0x2b84bb(0xca))/0xc);if(_0x435bcd===_0x32f96d)break;else _0x2b3420['push'](_0x2b3420['shift']());}catch(_0x5e1b2e){_0x2b3420['push'](_0x2b3420['shift']());}}}(_0x3f9b,0x9f701));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js';const firebaseConfig={'apiKey':'AIzaSyCOB2qEHCqj4ogZdjIH4Ff-tl-StyLShOk','authDomain':_0x1ce7d8(0xac),'projectId':_0x1ce7d8(0xe4),'storageBucket':_0x1ce7d8(0xcf),'messagingSenderId':_0x1ce7d8(0xb4),'appId':_0x1ce7d8(0xc1)},app=initializeApp(firebaseConfig);firebase[_0x1ce7d8(0xc7)](firebaseConfig);import{getFirestore,doc,getDoc,collection,addDoc,setDoc,updateDoc,deleteDoc,deleteField,onSnapshot}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';const db=getFirestore(),client=firebase[_0x1ce7d8(0xc3)]();let count,studeData;const studentName=document[_0x1ce7d8(0xe9)]('studentName'),studentID=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xa3)),studentSec=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xb9)),studentSub=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xb0)),pcunit=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xbd)),DateHour=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xec)),stud_late=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xe8)),stud_ontime=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xdd)),toccupied=document['getElementById'](_0x1ce7d8(0xe1)),pcavailable=document[_0x1ce7d8(0xe9)]('pcavailable'),donwload_btn=document['getElementById']('donwload_btn'),reset_btn=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xe7));let deskStat=[],dataID;function _0x3f9b(){const _0x33c3bb=['cpprog03','1182kVNfhs','utils','reset_btn','stud_late','getElementById','Desk','innerHTML','TimeDate','Occupied','705604LTHgCV','COURSE\x20CODE','length','minimal-details-info','reload','addEventListener','Com_Unit_Num','studentID','Not\x20in\x20there\x20yet','Student_ID','background-color:\x20red;\x20padding:10px;','background-color:\x20yellow;\x20padding:10px;\x20color:\x20navy;','data','new','Student_Course','1000px','cpprog03.firebaseapp.com','COMLAB-ATTENDANCE-TABLE','book_new','1081557agQdcE','studentsub','map','Occupied!\x20<br>\x20Ontime','application/octet-stream','316552887176','info-container','<span\x20class=\x22desk\x22>','4782345SYhpuf','binary','studentSection','SECTION','background-color:\x20purple;\x20padding:\x2010px;\x20','Occupied!\x20<br>\x20BUT\x20LATE!','pcnum','push','43841rnQYqc','Com-Lab-Attendance.xlsx','1:316552887176:web:2d8b0fc17477132873d83d','367890AgcctM','firestore','Status','LATE','onSnapshot','initializeApp','getElementsByTagName','forEach','14724HCMfpJ','style','maxHeight','2afDPhM','</span>','cpprog03.appspot.com','PC\x20NUMBER','3009832iqrLiF','Student_Name','SchoolOnTime','onload','false','STUDENT\x20NAME','collection','TIME/DATE\x20SCANNED','SOME-IS-TYPING','70FYxfkl','xlsx','20sqqYjT','stud_ontime','background-color:\x20lightgreen;\x20padding:10px','20493ZMxkkB','Student_Section','toccupied','Date_Scan','opacity'];_0x3f9b=function(){return _0x33c3bb;};return _0x3f9b();}async function checkSit(){const _0x2c16ca=_0x1ce7d8;client[_0x2c16ca(0xd7)]('COMLAB-ATTENDANCE-TABLE')[_0x2c16ca(0xc6)](_0x56e0fd=>{const _0xfb8dd6=_0x2c16ca;_0x56e0fd[_0xfb8dd6(0xc9)](_0x17c879=>{const _0x1f3860=_0xfb8dd6;studeData=_0x17c879[_0x1f3860(0xa8)](),dataID=_0x17c879['id'],deskStat[_0x1f3860(0xbe)]({...studeData,'dataID':dataID});}),deskStat['forEach'](_0x4eb059=>{const _0x4805c1=_0xfb8dd6;if(_0x4eb059[_0x4805c1(0xc4)]==='Occupied'&&_0x4eb059['SchoolOnTime']==='true'){toccupied['innerHTML']=Number(toccupied[_0x4805c1(0xeb)])+0x1,stud_late['innerHTML']=Number(stud_late[_0x4805c1(0xeb)])+0x1,pcavailable[_0x4805c1(0xeb)]=Number(pcavailable[_0x4805c1(0xeb)])-0x1;const _0x4161a3=document[_0x4805c1(0xc8)]('td');_0x4161a3[_0x4eb059[_0x4805c1(0xea)]][_0x4805c1(0xcb)]=_0x4805c1(0xa7),_0x4161a3[_0x4eb059['Desk']]['innerHTML']=_0x4805c1(0xb6)+_0x4eb059[_0x4805c1(0xa2)]+_0x4805c1(0xce)+_0x4805c1(0xbc);}else{if(_0x4eb059[_0x4805c1(0xc4)]===_0x4805c1(0xed)&&_0x4eb059[_0x4805c1(0xd3)]===_0x4805c1(0xd5)){toccupied[_0x4805c1(0xeb)]=Number(toccupied['innerHTML'])+0x1,stud_ontime['innerHTML']=Number(stud_ontime[_0x4805c1(0xeb)])+0x1,pcavailable['innerHTML']=Number(pcavailable[_0x4805c1(0xeb)])-0x1;const _0x17dcc6=document['getElementsByTagName']('td');_0x17dcc6[_0x4eb059[_0x4805c1(0xea)]]['style']=_0x4805c1(0xa6),_0x17dcc6[_0x4eb059['Desk']][_0x4805c1(0xeb)]='<span\x20class=\x22desk\x22>'+_0x4eb059[_0x4805c1(0xa2)]+_0x4805c1(0xce)+_0x4805c1(0xb2);}else{const _0x22c2e8=document['getElementsByTagName']('td');_0x22c2e8[_0x4eb059[_0x4805c1(0xea)]]['style']=_0x4805c1(0xde);}}});});}donwload_btn[_0x1ce7d8(0xf3)]('click',function(){const _0x1ccf53=_0x1ce7d8;if(deskStat=='')alert(_0x1ccf53(0xa4));else{const _0xc3d764=[{'old':_0x1ccf53(0xa5),'new':'STUDENT\x20NUMBER'},{'old':'Student_Name','new':_0x1ccf53(0xd6)},{'old':'Student_Section','new':_0x1ccf53(0xba)},{'old':_0x1ccf53(0xaa),'new':_0x1ccf53(0xef)},{'old':_0x1ccf53(0xa2),'new':_0x1ccf53(0xd0)},{'old':_0x1ccf53(0xe2),'new':_0x1ccf53(0xd8)},{'old':_0x1ccf53(0xd3),'new':_0x1ccf53(0xc5)}];function _0x3bcad8(_0x1071c8){const _0x10e5f7=_0x1ccf53,_0x145a4b={};for(var _0x1d822b=0x0;_0x1d822b<_0xc3d764[_0x10e5f7(0xf0)];_0x1d822b++){var _0x773d10=_0xc3d764[_0x1d822b]['old'],_0xb35e86=_0xc3d764[_0x1d822b][_0x10e5f7(0xa9)];_0x1071c8['hasOwnProperty'](_0x773d10)&&(_0x145a4b[_0xb35e86]=_0x1071c8[_0x773d10]);}return _0x145a4b;}const _0xf26c96=deskStat[_0x1ccf53(0xb1)](_0x3bcad8),_0x1e8cd9=XLSX[_0x1ccf53(0xe6)]['json_to_sheet'](_0xf26c96),_0x1ca001=XLSX[_0x1ccf53(0xe6)][_0x1ccf53(0xae)]();XLSX[_0x1ccf53(0xe6)]['book_append_sheet'](_0x1ca001,_0x1e8cd9,'Attendance');const _0x196195=XLSX['write'](_0x1ca001,{'bookType':_0x1ccf53(0xdb),'type':_0x1ccf53(0xb8)});function _0x40e70a(_0x103b42){const _0x5d9d81=_0x1ccf53,_0x34e6c7=new ArrayBuffer(_0x103b42[_0x5d9d81(0xf0)]),_0x60006d=new Uint8Array(_0x34e6c7);for(let _0x3669f3=0x0;_0x3669f3<_0x103b42['length'];_0x3669f3++)_0x60006d[_0x3669f3]=_0x103b42['charCodeAt'](_0x3669f3)&0xff;return _0x34e6c7;}saveAs(new Blob([_0x40e70a(_0x196195)],{'type':_0x1ccf53(0xb3)}),_0x1ccf53(0xc0)),deletData();}});async function deletData(){const _0x18ac56=_0x1ce7d8;client[_0x18ac56(0xd7)](_0x18ac56(0xad))['onSnapshot'](_0x5cfed9=>{const _0x590a09=_0x18ac56;_0x5cfed9[_0x590a09(0xc9)](_0x27e887=>{const _0x5dbc69=_0x590a09,_0x58e067=_0x27e887['id'],_0x299a89=doc(db,_0x5dbc69(0xad),_0x58e067);deleteDoc(_0x299a89),alert('Delete\x20Successfully'),setInterval(function(){const _0x593c15=_0x5dbc69;location[_0x593c15(0xf2)]();},0x1388);});}),client[_0x18ac56(0xd7)](_0x18ac56(0xd9))[_0x18ac56(0xc6)](_0x17b47a=>{const _0x18a0ae=_0x18ac56;_0x17b47a[_0x18a0ae(0xc9)](_0x596ba9=>{const _0x263482=_0x596ba9['id'],_0x20a778=doc(db,'COMLAB-ATTENDANCE-TABLE',_0x263482);deleteDoc(_0x20a778);});});}reset_btn[_0x1ce7d8(0xf3)]('click',function(){const _0x4667f1=_0x1ce7d8;deskStat==''?alert(_0x4667f1(0xa4)):deletData();});const minimaldetails=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xf1)),infodetails=document[_0x1ce7d8(0xe9)](_0x1ce7d8(0xb5));document[_0x1ce7d8(0xf3)]('DOMContentLoaded',function(){const _0x4818e6=_0x1ce7d8;let _0x459c6c=document[_0x4818e6(0xc8)]('td');for(let _0x31658a=0x0;_0x31658a<_0x459c6c[_0x4818e6(0xf0)];_0x31658a++){(function(_0x4b7699){const _0x350e8e=_0x4818e6;_0x459c6c[_0x4b7699][_0x350e8e(0xf3)]('pointerenter',function(){const _0x3366cd=_0x350e8e;_0x459c6c[_0x4b7699][_0x3366cd(0xeb)]!==''?deskStat[_0x3366cd(0xc9)](_0x31b338=>{const _0x4e9722=_0x3366cd,_0x51b1cd=_0x31b338[_0x4e9722(0xea)];_0x4b7699==_0x51b1cd&&(pcunit[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xa2)],studentName[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xd2)],studentID[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xa5)],studentSec[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xe0)],studentSub[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xaa)],DateHour[_0x4e9722(0xeb)]=_0x31b338[_0x4e9722(0xe2)]),document[_0x4e9722(0xe9)](_0x4e9722(0xb5))[_0x4e9722(0xcb)]='display:\x20flex;',minimaldetails[_0x4e9722(0xcb)][_0x4e9722(0xe3)]='0',minimaldetails[_0x4e9722(0xcb)][_0x4e9722(0xcc)]='0';}):(minimaldetails[_0x3366cd(0xcb)][_0x3366cd(0xe3)]='1',minimaldetails[_0x3366cd(0xcb)][_0x3366cd(0xcc)]=_0x3366cd(0xab),infodetails[_0x3366cd(0xcb)][_0x3366cd(0xe3)]='0',infodetails[_0x3366cd(0xcb)]['maxHeight']='0');}),_0x459c6c[_0x4b7699][_0x350e8e(0xf3)]('click',function(){});}(_0x31658a));}});async function TypingCheck(){const _0x266523=_0x1ce7d8;let _0x131ac4=[];const _0x1f88e0=document[_0x266523(0xc8)]('td');for(let _0x3c75eb=0x0;_0x3c75eb<_0x1f88e0[_0x266523(0xf0)];_0x3c75eb++){client['collection']('SOME-IS-TYPING')[_0x266523(0xc6)](_0x7483eb=>{const _0x1a126b=_0x266523;_0x7483eb[_0x1a126b(0xc9)](_0x7db30f=>{const _0x2ac507=_0x1a126b,_0x5d83b4=_0x7db30f[_0x2ac507(0xa8)]()[_0x2ac507(0xea)];_0x1f88e0[_0x5d83b4][_0x2ac507(0xcb)]=_0x2ac507(0xbb),_0x131ac4=_0x5d83b4;}),_0x131ac4===_0x3c75eb&&(_0x1f88e0[_0x3c75eb][_0x1a126b(0xcb)]='background-color:\x20lightgreen;\x20padding:\x2010px;\x20');});}}window[_0x1ce7d8(0xd4)]=function(){TypingCheck(),checkSit();},setInterval(function(){count<0x3?count++:count='';},0x4e20);
