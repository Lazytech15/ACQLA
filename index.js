const _0x216dfb=_0x5731;(function(_0x1b697b,_0x1343e9){const _0x27f6e8=_0x5731,_0x17404a=_0x1b697b();while(!![]){try{const _0x3aeb5a=parseInt(_0x27f6e8(0x214))/0x1+-parseInt(_0x27f6e8(0x1ee))/0x2+-parseInt(_0x27f6e8(0x22a))/0x3+parseInt(_0x27f6e8(0x202))/0x4+-parseInt(_0x27f6e8(0x1f2))/0x5+parseInt(_0x27f6e8(0x204))/0x6*(parseInt(_0x27f6e8(0x225))/0x7)+-parseInt(_0x27f6e8(0x20a))/0x8*(-parseInt(_0x27f6e8(0x1fb))/0x9);if(_0x3aeb5a===_0x1343e9)break;else _0x17404a['push'](_0x17404a['shift']());}catch(_0x13ab14){_0x17404a['push'](_0x17404a['shift']());}}}(_0x19c4,0x562ee));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js';const firebaseConfig={'apiKey':_0x216dfb(0x1e5),'authDomain':_0x216dfb(0x221),'projectId':_0x216dfb(0x1ef),'storageBucket':'cpprog03.appspot.com','messagingSenderId':_0x216dfb(0x1f5),'appId':_0x216dfb(0x22d)},app=initializeApp(firebaseConfig);function _0x19c4(){const _0x4bad21=['</span>','data','donwload_btn','getElementsByTagName','binary','697016eHqpwX','cpprog03','TIME/DATE\x20SCANNED','studentName','625695KmfEqc','innerHTML','Delete\x20Successfully','316552887176','info-container','json_to_sheet','book_append_sheet','Desk','utils','9QLAXRS','SOME-IS-TYPING','charCodeAt','collection','background-color:\x20yellow;\x20padding:10px;\x20color:\x20navy;','Student_Course','TimeDate','956360pxiRzN','1000px','9822rSLjxc','pcavailable','onload','COMLAB-ATTENDANCE-TABLE','stud_late','maxHeight','5179176WBDTUj','forEach','click','Status','firestore','Student_Section','Student_Name','STUDENT\x20NUMBER','Student_ID','background-color:\x20lightgreen;\x20padding:\x2010px;\x20','441604TqNXEz','Com_Unit_Num','Occupied!\x20<br>\x20BUT\x20LATE!','book_new','false','STUDENT\x20NAME','studentsub','<span\x20class=\x22desk\x22>','Not\x20in\x20there\x20yet','pointerenter','reload','style','hasOwnProperty','cpprog03.firebaseapp.com','background-color:\x20purple;\x20padding:\x2010px;\x20','onSnapshot','Attendance','721yXPlvn','map','Occupied!\x20<br>\x20Ontime','studentID','addEventListener','2010147RGmvbD','SchoolOnTime','background-color:\x20red;\x20padding:10px;','1:316552887176:web:2d8b0fc17477132873d83d','new','length','getElementById','PC\x20NUMBER','opacity','AIzaSyCOB2qEHCqj4ogZdjIH4Ff-tl-StyLShOk','Date_Scan','display:\x20flex;','xlsx'];_0x19c4=function(){return _0x4bad21;};return _0x19c4();}firebase['initializeApp'](firebaseConfig);import{getFirestore,doc,getDoc,collection,addDoc,setDoc,updateDoc,deleteDoc,deleteField,onSnapshot}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';const db=getFirestore(),client=firebase[_0x216dfb(0x20e)]();let count,studeData;const studentName=document['getElementById'](_0x216dfb(0x1f1)),studentID=document[_0x216dfb(0x230)](_0x216dfb(0x228)),studentSec=document[_0x216dfb(0x230)]('studentSection'),studentSub=document['getElementById'](_0x216dfb(0x21a)),pcunit=document[_0x216dfb(0x230)]('pcnum'),DateHour=document[_0x216dfb(0x230)](_0x216dfb(0x201)),stud_late=document[_0x216dfb(0x230)](_0x216dfb(0x208)),stud_ontime=document[_0x216dfb(0x230)]('stud_ontime'),toccupied=document[_0x216dfb(0x230)]('toccupied'),pcavailable=document[_0x216dfb(0x230)](_0x216dfb(0x205)),donwload_btn=document[_0x216dfb(0x230)](_0x216dfb(0x1eb));let deskStat=[],dataID;async function checkSit(){const _0x151b4a=_0x216dfb;client[_0x151b4a(0x1fe)]('COMLAB-ATTENDANCE-TABLE')['onSnapshot'](_0x4ef227=>{const _0x165db4=_0x151b4a;_0x4ef227[_0x165db4(0x20b)](_0x4f7570=>{studeData=_0x4f7570['data'](),dataID=_0x4f7570['id'],deskStat['push']({...studeData,'dataID':dataID});}),deskStat['forEach'](_0x22bf25=>{const _0x328119=_0x165db4;if(_0x22bf25[_0x328119(0x20d)]==='Occupied'&&_0x22bf25[_0x328119(0x22b)]==='true'){toccupied[_0x328119(0x1f3)]=Number(toccupied[_0x328119(0x1f3)])+0x1,stud_late[_0x328119(0x1f3)]=Number(stud_late[_0x328119(0x1f3)])+0x1,pcavailable[_0x328119(0x1f3)]=Number(pcavailable[_0x328119(0x1f3)])-0x1;const _0x28dac3=document[_0x328119(0x1ec)]('td');_0x28dac3[_0x22bf25[_0x328119(0x1f9)]][_0x328119(0x21f)]=_0x328119(0x1ff),_0x28dac3[_0x22bf25[_0x328119(0x1f9)]][_0x328119(0x1f3)]=_0x328119(0x21b)+_0x22bf25[_0x328119(0x215)]+_0x328119(0x1e9)+_0x328119(0x216);}else{if(_0x22bf25[_0x328119(0x20d)]==='Occupied'&&_0x22bf25[_0x328119(0x22b)]===_0x328119(0x218)){toccupied[_0x328119(0x1f3)]=Number(toccupied[_0x328119(0x1f3)])+0x1,stud_ontime[_0x328119(0x1f3)]=Number(stud_ontime[_0x328119(0x1f3)])+0x1,pcavailable['innerHTML']=Number(pcavailable['innerHTML'])-0x1;const _0x551173=document['getElementsByTagName']('td');_0x551173[_0x22bf25[_0x328119(0x1f9)]][_0x328119(0x21f)]=_0x328119(0x22c),_0x551173[_0x22bf25[_0x328119(0x1f9)]][_0x328119(0x1f3)]=_0x328119(0x21b)+_0x22bf25[_0x328119(0x215)]+_0x328119(0x1e9)+_0x328119(0x227);}else{const _0x976d1c=document[_0x328119(0x1ec)]('td');_0x976d1c[_0x22bf25[_0x328119(0x1f9)]][_0x328119(0x21f)]='background-color:\x20lightgreen;\x20padding:10px';}}});});}donwload_btn[_0x216dfb(0x229)](_0x216dfb(0x20c),function(){const _0x101196=_0x216dfb;if(deskStat=='')alert(_0x101196(0x21c));else{const _0x36f3e0=[{'old':_0x101196(0x212),'new':_0x101196(0x211)},{'old':_0x101196(0x210),'new':_0x101196(0x219)},{'old':_0x101196(0x20f),'new':'SECTION'},{'old':'Student_Course','new':'COURSE\x20CODE'},{'old':_0x101196(0x215),'new':_0x101196(0x231)},{'old':_0x101196(0x1e6),'new':_0x101196(0x1f0)},{'old':'SchoolOnTime','new':'LATE'}];function _0x32a8b6(_0x339408){const _0x177bf2=_0x101196,_0x14862d={};for(var _0x318cde=0x0;_0x318cde<_0x36f3e0[_0x177bf2(0x22f)];_0x318cde++){var _0x545b43=_0x36f3e0[_0x318cde]['old'],_0x31da89=_0x36f3e0[_0x318cde][_0x177bf2(0x22e)];_0x339408[_0x177bf2(0x220)](_0x545b43)&&(_0x14862d[_0x31da89]=_0x339408[_0x545b43]);}return _0x14862d;}const _0x21bc44=deskStat[_0x101196(0x226)](_0x32a8b6),_0x4745f7=XLSX[_0x101196(0x1fa)][_0x101196(0x1f7)](_0x21bc44),_0x1a509e=XLSX[_0x101196(0x1fa)][_0x101196(0x217)]();XLSX[_0x101196(0x1fa)][_0x101196(0x1f8)](_0x1a509e,_0x4745f7,_0x101196(0x224));const _0x27c286=XLSX['write'](_0x1a509e,{'bookType':_0x101196(0x1e8),'type':_0x101196(0x1ed)});function _0x1e9268(_0x95f43c){const _0x4ba0bc=_0x101196,_0x69a514=new ArrayBuffer(_0x95f43c[_0x4ba0bc(0x22f)]),_0x5f20b2=new Uint8Array(_0x69a514);for(let _0x1e1ce9=0x0;_0x1e1ce9<_0x95f43c[_0x4ba0bc(0x22f)];_0x1e1ce9++)_0x5f20b2[_0x1e1ce9]=_0x95f43c[_0x4ba0bc(0x1fd)](_0x1e1ce9)&0xff;return _0x69a514;}saveAs(new Blob([_0x1e9268(_0x27c286)],{'type':'application/octet-stream'}),'Com-Lab-Attendance.xlsx'),deletData();}});function _0x5731(_0x1938e4,_0x5537f7){const _0x19c400=_0x19c4();return _0x5731=function(_0x573114,_0x4eb681){_0x573114=_0x573114-0x1e4;let _0x3f5f62=_0x19c400[_0x573114];return _0x3f5f62;},_0x5731(_0x1938e4,_0x5537f7);}async function deletData(){const _0x42c176=_0x216dfb;client[_0x42c176(0x1fe)](_0x42c176(0x207))['onSnapshot'](_0x2884a7=>{const _0x2423d2=_0x42c176;_0x2884a7[_0x2423d2(0x20b)](_0x2ebf0b=>{const _0x455801=_0x2423d2,_0x42d7db=_0x2ebf0b['id'],_0x2ae666=doc(db,'COMLAB-ATTENDANCE-TABLE',_0x42d7db);deleteDoc(_0x2ae666),alert(_0x455801(0x1f4)),setInterval(function(){const _0xa24995=_0x455801;location[_0xa24995(0x21e)]();},0x1388);});}),client[_0x42c176(0x1fe)](_0x42c176(0x1fc))['onSnapshot'](_0x4ee655=>{const _0x140e71=_0x42c176;_0x4ee655[_0x140e71(0x20b)](_0x11fc19=>{const _0x1d1fd3=_0x140e71,_0x38ccf0=_0x11fc19['id'],_0x1ba8f5=doc(db,_0x1d1fd3(0x207),_0x38ccf0);deleteDoc(_0x1ba8f5);});});}const minimaldetails=document[_0x216dfb(0x230)]('minimal-details-info'),infodetails=document[_0x216dfb(0x230)](_0x216dfb(0x1f6));document['addEventListener']('DOMContentLoaded',function(){const _0xac67c0=_0x216dfb;let _0x33cb1b=document[_0xac67c0(0x1ec)]('td');for(let _0x5b541a=0x0;_0x5b541a<_0x33cb1b[_0xac67c0(0x22f)];_0x5b541a++){(function(_0x25e0cf){const _0xf5b502=_0xac67c0;_0x33cb1b[_0x25e0cf][_0xf5b502(0x229)](_0xf5b502(0x21d),function(){const _0x55f8f4=_0xf5b502;_0x33cb1b[_0x25e0cf][_0x55f8f4(0x1f3)]!==''?deskStat['forEach'](_0xe4e2d3=>{const _0x45d86a=_0x55f8f4,_0xc9f84d=_0xe4e2d3['Desk'];_0x25e0cf==_0xc9f84d&&(pcunit['innerHTML']=_0xe4e2d3['Com_Unit_Num'],studentName[_0x45d86a(0x1f3)]=_0xe4e2d3[_0x45d86a(0x210)],studentID['innerHTML']=_0xe4e2d3[_0x45d86a(0x212)],studentSec[_0x45d86a(0x1f3)]=_0xe4e2d3[_0x45d86a(0x20f)],studentSub[_0x45d86a(0x1f3)]=_0xe4e2d3[_0x45d86a(0x200)],DateHour[_0x45d86a(0x1f3)]=_0xe4e2d3[_0x45d86a(0x1e6)]),document[_0x45d86a(0x230)](_0x45d86a(0x1f6))[_0x45d86a(0x21f)]=_0x45d86a(0x1e7),minimaldetails[_0x45d86a(0x21f)][_0x45d86a(0x1e4)]='0',minimaldetails[_0x45d86a(0x21f)]['maxHeight']='0';}):(minimaldetails[_0x55f8f4(0x21f)]['opacity']='1',minimaldetails[_0x55f8f4(0x21f)][_0x55f8f4(0x209)]=_0x55f8f4(0x203),infodetails['style'][_0x55f8f4(0x1e4)]='0',infodetails['style'][_0x55f8f4(0x209)]='0');}),_0x33cb1b[_0x25e0cf][_0xf5b502(0x229)](_0xf5b502(0x20c),function(){});}(_0x5b541a));}});async function TypingCheck(){const _0xede045=_0x216dfb;let _0x3ebb82=[];const _0x1aea0f=document[_0xede045(0x1ec)]('td');for(let _0x4451c4=0x0;_0x4451c4<_0x1aea0f['length'];_0x4451c4++){client[_0xede045(0x1fe)](_0xede045(0x1fc))[_0xede045(0x223)](_0x42889=>{const _0x38ec79=_0xede045;_0x42889[_0x38ec79(0x20b)](_0x3b2470=>{const _0xd0c7af=_0x38ec79,_0x5214b1=_0x3b2470[_0xd0c7af(0x1ea)]()[_0xd0c7af(0x1f9)];_0x1aea0f[_0x5214b1]['style']=_0xd0c7af(0x222),_0x3ebb82=_0x5214b1;}),_0x3ebb82===_0x4451c4&&(_0x1aea0f[_0x4451c4][_0x38ec79(0x21f)]=_0x38ec79(0x213));});}}window[_0x216dfb(0x206)]=function(){TypingCheck(),checkSit();},setInterval(function(){count<0x3?count++:count='';},0x4e20);
