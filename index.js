const _0x3fa1fb=_0x17b4;(function(_0x1275f1,_0x156f13){const _0x4247bd=_0x17b4,_0xcb91c8=_0x1275f1();while(!![]){try{const _0x4c75f5=parseInt(_0x4247bd(0x180))/0x1*(-parseInt(_0x4247bd(0x15d))/0x2)+parseInt(_0x4247bd(0x14e))/0x3*(-parseInt(_0x4247bd(0x152))/0x4)+-parseInt(_0x4247bd(0x15c))/0x5*(-parseInt(_0x4247bd(0x147))/0x6)+parseInt(_0x4247bd(0x17b))/0x7+-parseInt(_0x4247bd(0x184))/0x8+-parseInt(_0x4247bd(0x140))/0x9+parseInt(_0x4247bd(0x158))/0xa;if(_0x4c75f5===_0x156f13)break;else _0xcb91c8['push'](_0xcb91c8['shift']());}catch(_0xc6017c){_0xcb91c8['push'](_0xcb91c8['shift']());}}}(_0x352f,0x64567));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js';const firebaseConfig={'apiKey':_0x3fa1fb(0x138),'authDomain':_0x3fa1fb(0x16c),'projectId':_0x3fa1fb(0x156),'storageBucket':_0x3fa1fb(0x179),'messagingSenderId':_0x3fa1fb(0x170),'appId':'1:316552887176:web:2d8b0fc17477132873d83d'},app=initializeApp(firebaseConfig);firebase[_0x3fa1fb(0x160)](firebaseConfig);import{getFirestore,doc,getDoc,collection,addDoc,setDoc,updateDoc,deleteDoc,deleteField,onSnapshot}from'https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js';const db=getFirestore(),client=firebase[_0x3fa1fb(0x176)]();let count,studeData;const studentName=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x15f)),studentID=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x16b)),studentSec=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x13e)),studentSub=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x13d)),pcunit=document['getElementById'](_0x3fa1fb(0x142)),DateHour=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x17e)),stud_late=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x153)),stud_ontime=document['getElementById'](_0x3fa1fb(0x174)),toccupied=document[_0x3fa1fb(0x144)]('toccupied'),pcavailable=document[_0x3fa1fb(0x144)]('pcavailable'),donwload_btn=document[_0x3fa1fb(0x144)]('donwload_btn'),reset_btn=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x14c));function _0x17b4(_0xa6a1e2,_0x17f742){const _0x352fcd=_0x352f();return _0x17b4=function(_0x17b499,_0x943fdd){_0x17b499=_0x17b499-0x130;let _0x7dc41c=_0x352fcd[_0x17b499];return _0x7dc41c;},_0x17b4(_0xa6a1e2,_0x17f742);}let deskStat=[],dataID;async function checkSit(){const _0x54b470=_0x3fa1fb;client[_0x54b470(0x17f)](_0x54b470(0x159))[_0x54b470(0x187)](_0x2240d3=>{const _0x4fcb04=_0x54b470;_0x2240d3['forEach'](_0xd11832=>{const _0x4257c6=_0x17b4;studeData=_0xd11832['data'](),dataID=_0xd11832['id'],deskStat[_0x4257c6(0x14f)]({...studeData,'dataID':dataID});}),deskStat[_0x4fcb04(0x154)](_0x2d0647=>{const _0x1d7462=_0x4fcb04;if(_0x2d0647[_0x1d7462(0x17a)]==='Occupied'&&_0x2d0647[_0x1d7462(0x168)]===_0x1d7462(0x14a)){toccupied[_0x1d7462(0x17c)]=Number(toccupied[_0x1d7462(0x17c)])+0x1,stud_late[_0x1d7462(0x17c)]=Number(stud_late[_0x1d7462(0x17c)])+0x1,pcavailable[_0x1d7462(0x17c)]=Number(pcavailable['innerHTML'])-0x1;const _0x17569b=document[_0x1d7462(0x167)]('td');_0x17569b[_0x2d0647[_0x1d7462(0x182)]][_0x1d7462(0x135)]='background-color:\x20yellow;\x20padding:10px;\x20color:\x20navy;',_0x17569b[_0x2d0647[_0x1d7462(0x182)]][_0x1d7462(0x17c)]=_0x1d7462(0x13c)+_0x2d0647[_0x1d7462(0x151)]+_0x1d7462(0x136)+_0x1d7462(0x148);}else{if(_0x2d0647[_0x1d7462(0x17a)]===_0x1d7462(0x185)&&_0x2d0647[_0x1d7462(0x168)]===_0x1d7462(0x164)){toccupied['innerHTML']=Number(toccupied[_0x1d7462(0x17c)])+0x1,stud_ontime[_0x1d7462(0x17c)]=Number(stud_ontime[_0x1d7462(0x17c)])+0x1,pcavailable[_0x1d7462(0x17c)]=Number(pcavailable[_0x1d7462(0x17c)])-0x1;const _0x3e420b=document[_0x1d7462(0x167)]('td');_0x3e420b[_0x2d0647[_0x1d7462(0x182)]][_0x1d7462(0x135)]=_0x1d7462(0x165),_0x3e420b[_0x2d0647[_0x1d7462(0x182)]][_0x1d7462(0x17c)]=_0x1d7462(0x13c)+_0x2d0647[_0x1d7462(0x151)]+_0x1d7462(0x136)+'Occupied!\x20<br>\x20Ontime';}else{const _0x3fe66a=document['getElementsByTagName']('td');_0x3fe66a[_0x2d0647['Desk']][_0x1d7462(0x135)]='background-color:\x20lightgreen;\x20padding:10px';}}});});}donwload_btn[_0x3fa1fb(0x183)]('click',function(){const _0x52aed7=_0x3fa1fb;if(deskStat=='')alert('Not\x20in\x20there\x20yet');else{const _0x282ec4=[{'old':'Student_ID','new':_0x52aed7(0x134)},{'old':_0x52aed7(0x145),'new':'STUDENT\x20NAME'},{'old':_0x52aed7(0x131),'new':_0x52aed7(0x173)},{'old':_0x52aed7(0x15a),'new':_0x52aed7(0x13b)},{'old':_0x52aed7(0x151),'new':_0x52aed7(0x181)},{'old':'Date_Scan','new':_0x52aed7(0x172)},{'old':_0x52aed7(0x168),'new':'LATE'}];function _0x1a44ba(_0x1cc6eb){const _0x34f39c=_0x52aed7,_0x1f0e72={};for(var _0x3df3f0=0x0;_0x3df3f0<_0x282ec4[_0x34f39c(0x141)];_0x3df3f0++){var _0x453c4f=_0x282ec4[_0x3df3f0][_0x34f39c(0x130)],_0x4b7521=_0x282ec4[_0x3df3f0][_0x34f39c(0x169)];_0x1cc6eb[_0x34f39c(0x177)](_0x453c4f)&&(_0x1f0e72[_0x4b7521]=_0x1cc6eb[_0x453c4f]);}return _0x1f0e72;}const _0x40610d=deskStat['map'](_0x1a44ba),_0x3a4b46=XLSX[_0x52aed7(0x132)]['json_to_sheet'](_0x40610d),_0x51a425=XLSX[_0x52aed7(0x132)][_0x52aed7(0x163)]();XLSX[_0x52aed7(0x132)][_0x52aed7(0x139)](_0x51a425,_0x3a4b46,_0x52aed7(0x13a));const _0x571db4=XLSX[_0x52aed7(0x15b)](_0x51a425,{'bookType':'xlsx','type':'binary'});function _0x5db3ad(_0x1224f8){const _0x2afa44=_0x52aed7,_0x2e7cfa=new ArrayBuffer(_0x1224f8[_0x2afa44(0x141)]),_0x14abc2=new Uint8Array(_0x2e7cfa);for(let _0x2bb8b6=0x0;_0x2bb8b6<_0x1224f8[_0x2afa44(0x141)];_0x2bb8b6++)_0x14abc2[_0x2bb8b6]=_0x1224f8['charCodeAt'](_0x2bb8b6)&0xff;return _0x2e7cfa;}saveAs(new Blob([_0x5db3ad(_0x571db4)],{'type':'application/octet-stream'}),'Com-Lab-Attendance.xlsx'),deletData(),document[_0x52aed7(0x144)]('pop-up-message')[_0x52aed7(0x17c)]=_0x52aed7(0x149),document['getElementById'](_0x52aed7(0x15e))['style'][_0x52aed7(0x186)]=_0x52aed7(0x16e),myPopup[_0x52aed7(0x14d)]['add'](_0x52aed7(0x143));}});async function deletData(){const _0x5a8d9e=_0x3fa1fb;client['collection'](_0x5a8d9e(0x159))['onSnapshot'](_0x36cfc8=>{const _0x43d9f2=_0x5a8d9e;_0x36cfc8[_0x43d9f2(0x154)](_0x2292d7=>{const _0x38a029=_0x43d9f2,_0x204e2f=_0x2292d7['id'],_0x5a2923=doc(db,_0x38a029(0x159),_0x204e2f);deleteDoc(_0x5a2923);});}),client[_0x5a8d9e(0x17f)](_0x5a8d9e(0x133))[_0x5a8d9e(0x187)](_0x242cb7=>{const _0x4c2c79=_0x5a8d9e;_0x242cb7[_0x4c2c79(0x154)](_0x2fec5c=>{const _0x17b830=_0x2fec5c['id'],_0x3681b8=doc(db,'COMLAB-ATTENDANCE-TABLE',_0x17b830);deleteDoc(_0x3681b8);});}),setInterval(function(){location['reload']();},0x1388);}reset_btn[_0x3fa1fb(0x183)](_0x3fa1fb(0x137),function(){const _0x2540b5=_0x3fa1fb;deskStat==''?(document[_0x2540b5(0x144)](_0x2540b5(0x15e))['innerHTML']='It\x27s\x20seem\x20that\x20there\x20is\x20no\x20data\x20yet!',document['getElementById'](_0x2540b5(0x15e))['style'][_0x2540b5(0x186)]=_0x2540b5(0x16e),myPopup[_0x2540b5(0x14d)][_0x2540b5(0x161)](_0x2540b5(0x143))):(document[_0x2540b5(0x144)](_0x2540b5(0x171))[_0x2540b5(0x135)]=_0x2540b5(0x16a),document[_0x2540b5(0x144)]('pop-up-message')['innerHTML']='Reset\x20Data\x20successfully!',document['getElementById'](_0x2540b5(0x15e))[_0x2540b5(0x135)]['textAlign']=_0x2540b5(0x16e),myPopup[_0x2540b5(0x14d)][_0x2540b5(0x161)](_0x2540b5(0x143)),deletData());});const minimaldetails=document[_0x3fa1fb(0x144)](_0x3fa1fb(0x150)),infodetails=document['getElementById'](_0x3fa1fb(0x16d));document[_0x3fa1fb(0x183)](_0x3fa1fb(0x162),function(){const _0x564c67=_0x3fa1fb;let _0x2e64cf=document[_0x564c67(0x167)]('td');for(let _0x5a6173=0x0;_0x5a6173<_0x2e64cf[_0x564c67(0x141)];_0x5a6173++){(function(_0x32d555){const _0x56168f=_0x564c67;_0x2e64cf[_0x32d555][_0x56168f(0x183)](_0x56168f(0x175),function(){const _0x85091c=_0x56168f;_0x2e64cf[_0x32d555][_0x85091c(0x17c)]!==''?deskStat['forEach'](_0xfa858c=>{const _0x5e6ffe=_0x85091c,_0x3779e3=_0xfa858c[_0x5e6ffe(0x182)];_0x32d555==_0x3779e3&&(pcunit['innerHTML']=_0xfa858c[_0x5e6ffe(0x151)],studentName[_0x5e6ffe(0x17c)]=_0xfa858c[_0x5e6ffe(0x145)],studentID[_0x5e6ffe(0x17c)]=_0xfa858c[_0x5e6ffe(0x146)],studentSec[_0x5e6ffe(0x17c)]=_0xfa858c[_0x5e6ffe(0x131)],studentSub[_0x5e6ffe(0x17c)]=_0xfa858c['Student_Course'],DateHour[_0x5e6ffe(0x17c)]=_0xfa858c[_0x5e6ffe(0x155)]),document['getElementById'](_0x5e6ffe(0x16d))['style']=_0x5e6ffe(0x166),minimaldetails['style'][_0x5e6ffe(0x157)]='0',minimaldetails[_0x5e6ffe(0x135)][_0x5e6ffe(0x14b)]='0';}):(minimaldetails[_0x85091c(0x135)]['opacity']='1',minimaldetails['style']['maxHeight']=_0x85091c(0x188),infodetails[_0x85091c(0x135)][_0x85091c(0x157)]='0',infodetails[_0x85091c(0x135)]['maxHeight']='0');}),_0x2e64cf[_0x32d555]['addEventListener'](_0x56168f(0x137),function(){});}(_0x5a6173));}});async function TypingCheck(){const _0x2f1fe3=_0x3fa1fb;let _0x4053b2=[];const _0xf76af9=document[_0x2f1fe3(0x167)]('td');for(let _0x2116ed=0x0;_0x2116ed<_0xf76af9[_0x2f1fe3(0x141)];_0x2116ed++){client[_0x2f1fe3(0x17f)](_0x2f1fe3(0x133))[_0x2f1fe3(0x187)](_0x19c9db=>{const _0x34448b=_0x2f1fe3;_0x19c9db[_0x34448b(0x154)](_0x27ac11=>{const _0x1ad949=_0x34448b,_0x55fe44=_0x27ac11['data']()['Desk'];_0xf76af9[_0x55fe44][_0x1ad949(0x135)]='background-color:\x20purple;\x20padding:\x2010px;\x20',_0x4053b2=_0x55fe44;}),_0x4053b2===_0x2116ed&&(_0xf76af9[_0x2116ed][_0x34448b(0x135)]=_0x34448b(0x16f));});}}closePopup[_0x3fa1fb(0x183)](_0x3fa1fb(0x137),function(){const _0x49c888=_0x3fa1fb;myPopup[_0x49c888(0x14d)][_0x49c888(0x17d)](_0x49c888(0x143));}),window[_0x3fa1fb(0x183)]('click',function(_0x276768){const _0x5b11c9=_0x3fa1fb;_0x276768[_0x5b11c9(0x178)]==myPopup&&myPopup['classList']['remove'](_0x5b11c9(0x143));}),window['onload']=function(){TypingCheck(),checkSit();},setInterval(function(){const _0x3b6081=_0x3fa1fb;count<0x3?count++:(location[_0x3b6081(0x13f)](),count='');},0x4e20);function _0x352f(){const _0x26dc6e=['studentsub','studentSection','reload','6305445woIgHI','length','pcnum','show','getElementById','Student_Name','Student_ID','6yKhaNu','Occupied!\x20<br>\x20BUT\x20LATE!','Download\x20Complete!\x20it\x20will\x20reset\x20all,\x20thank\x20you\x20for\x20using\x20ACQLA\x20your\x20simple\x20yet\x20useful\x20Online\x20Attendance','true','maxHeight','reset_btn','classList','1830588ISfGEQ','push','minimal-details-info','Com_Unit_Num','4pvEkTN','stud_late','forEach','Date_Scan','cpprog03','opacity','17184670fJdXBA','COMLAB-ATTENDANCE-TABLE','Student_Course','write','304960rgiMNq','2CwbPBk','pop-up-message','studentName','initializeApp','add','DOMContentLoaded','book_new','false','background-color:\x20red;\x20padding:10px;','display:\x20flex;','getElementsByTagName','SchoolOnTime','new','display:none','studentID','cpprog03.firebaseapp.com','info-container','center','background-color:\x20lightgreen;\x20padding:\x2010px;\x20','316552887176','pop-up-top','TIME/DATE\x20SCANNED','SECTION','stud_ontime','pointerenter','firestore','hasOwnProperty','target','cpprog03.appspot.com','Status','4371269BIAuul','innerHTML','remove','TimeDate','collection','677315gTNsYW','PC\x20NUMBER','Desk','addEventListener','38616moqexF','Occupied','textAlign','onSnapshot','1000px','old','Student_Section','utils','SOME-IS-TYPING','STUDENT\x20NUMBER','style','</span>','click','AIzaSyCOB2qEHCqj4ogZdjIH4Ff-tl-StyLShOk','book_append_sheet','Attendance','COURSE\x20CODE','<span\x20class=\x22desk\x22>'];_0x352f=function(){return _0x26dc6e;};return _0x352f();}
